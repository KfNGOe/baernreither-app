(window.webpackJsonp=window.webpackJsonp||[]).push([[58,146,276,277],{118:function(e,a){angular.module("graphdb.framework.core.directives.paginations",[]).directive("paginations",["$translate","$rootScope","$compile",function(e,a,t){return{link:function(e,n){const s=()=>{const a=t('<uib-pagination class="nav navbar-right" total-items="matchedElements.length" items-per-page="pageSize" ng-model="page" ng-change="changePagination()" direction-links="false" boundary-links="true" max-size="5" rotate="true" first-text="{{\'paginator.first.page.label\' | translate}}" last-text="{{\'paginator.last.page.label\' | translate}}"></uib-pagination>')(e);n.html(a)};s();const r=a.$on("$translateChangeSuccess",s);e.$on("$destroy",r)}}}])},299:function(e,a,t){"use strict";t.r(a);t(9),t(42),t(41),t(49);const n=angular.module("graphdb.framework.namespaces.controllers",["ui.bootstrap","graphdb.framework.core.services.repositories","graphdb.framework.core.services.jwtauth","graphdb.framework.rest.repositories.service","graphdb.framework.rest.rdf4j.repositories.service","toastr"]),s=function(){const e="[A-Z]|[a-z]|[À-Ö]|[Ø-ö]|[ø-˿]|[Ͱ-ͽ]|[Ϳ-῿]|[‌-‍]|[⁰-↏]|[Ⰰ-⿯]|[、-퟿]|[豈-﷏]|[ﷰ-�]",a="[A-Z]|[a-z]|[À-Ö]|[Ø-ö]|[ø-˿]|[Ͱ-ͽ]|[Ϳ-῿]|[‌-‍]|[⁰-↏]|[Ⰰ-⿯]|[、-퟿]|[豈-﷏]|[ﷰ-�]|_|-|[0-9]|·|[̀-ͯ]|[‿-⁀]";return new RegExp("^(?:"+e+")(?:(?:"+a+"|\\.)*(?:"+a+"))?$")}();n.controller("NamespacesCtrl",["$scope","$http","$repositories","toastr","$uibModal","ModalService","RepositoriesRestService","RDF4JRepositoriesRestService","$translate",function(e,a,t,n,r,c,i,o,p){e.namespaces={},e.namespace={},e.loader=!1,e.haveSelected=!1,e.pageSizeOptions=[10,20,50,100],e.page=1,e.pageSize=e.pageSizeOptions[0],e.displayedNamespaces=[],e.getNamespaces=function(){t.getActiveRepository()&&(e.loader=!0,e.namespaces={},o.getNamespaces(t.getActiveRepository()).success((function(a){e.namespaces=a.results.bindings.map((function(e){return{prefix:e.prefix.value,namespace:e.namespace.value}})),e.namespaces.length>0&&(e.namespaces.sort((function(e,a){const t=e.prefix.toUpperCase(),n=a.prefix.toUpperCase();return t<n?-1:t>n?1:0})),e.matchedElements=e.namespaces,l()),0===e.namespaces.length&&(e.loader=!1)})).error((function(a){const t=getError(a);n.error(t),e.loader=!1})))};const l=function(){angular.isDefined(e.namespaces)&&(e.displayedNamespaces=e.namespaces.slice(e.pageSize*(e.page-1),e.pageSize*e.page))};e.changePageSize=function(a){$(".ot-graph-page-size").removeClass("active"),e.page=1,e.searchNamespaces="",a&&(e.getNamespaces(),e.pageSize=a)},e.$watch("matchedElements",(function(){angular.isDefined(e.matchedElements)&&(e.displayedNamespaces=e.matchedElements.slice(e.pageSize*(e.page-1),e.pageSize*e.page))})),e.$watch((function(){return t.getActiveRepository()}),(function(){e.searchNamespaces="",e.getNamespaces(),e.selectedAll=!1})),e.onNamespaceSearch=function(){e.haveSelected=!1,e.selectedAll=!1,e.matchedElements=[],h(),m()};const m=function(){angular.forEach(e.namespaces,(function(a){-1===a.namespace.indexOf(e.searchNamespaces)&&-1===a.prefix.indexOf(e.searchNamespaces)||e.matchedElements.push(a)}))};e.saveNamespace=function(a,s){return e.loader=!0,o.updateNamespacePrefix(t.getActiveRepository(),s,a).then((function(){e.getNamespaces(),n.success(p.instant("namespace.saved")),e.loader=!1})).catch((function(a){const t=getError(a);return n.error(t,p.instant("common.error")),e.loader=!1,Promise.reject(a)}))},e.editPrefix=function(a,s){e.loader=!0,i.getPrefix(t.getActiveRepository(),{from:a,to:s,location:t.getActiveRepositoryObject().location}).success((function(){e.getNamespaces(),e.loader=!1})).error((function(a){const t=getError(a);n.error(t,p.instant("common.error")),e.loader=!1}))};e.editPrefixAndNamespace=async(e,a,t)=>{try{const n=a;let s=e;if(e||(s=""),!v(s,n))return"Prefix or namespace is invalid";const r=t.prefix;return d(s,r)&&await c.openSimpleModal({title:p.instant("namespace.confirm.replace"),message:p.instant("namespace.already.exists.msg"),warning:!0}).result,f(s,r,n)}catch(e){return"Prefix overwrite cancelled"}};const d=(a,t)=>!!e.namespaces.find(e=>e.prefix===a&&t!==a),f=(a,t,n)=>e.saveNamespace(t,n).then((function(){t!==a&&e.editPrefix(t,a)}));e.addNamespace=function(){if(e.namespace.prefix||(e.namespace.prefix=""),!v(e.namespace.prefix,e.namespace.namespace))return;e.selectedAll=!1;let a=!1;for(let t=0;t<e.namespaces.length;t++)e.namespaces[t].prefix===e.namespace.prefix&&(a=!0);a?c.openSimpleModal({title:p.instant("namespace.confirm.replace"),message:p.instant("namespace.already.exists.msg"),warning:!0}).result.then(u):u()};const u=()=>{e.saveNamespace(e.namespace.prefix,e.namespace.namespace).then(()=>{e.namespace.namespace="",e.namespace.prefix="",setTimeout(()=>{e.form.$setUntouched(),e.form.$setPristine()})}).catch(()=>{})};e.removeNamespace=function(e){c.openSimpleModal({title:p.instant("common.confirm.delete"),message:p.instant("namespace.warning.delete.msg",{prefix:e.prefix}),warning:!0}).result.then((function(){g(e)}))},e.checkAll=function(){angular.forEach(e.displayedNamespaces,(function(a){a.selected=e.selectedAll}))},e.deleteSelected=function(){let a=!1;angular.forEach(e.displayedNamespaces,(function(t){a||t.selected&&(a=!0,c.openSimpleModal({title:p.instant("common.confirm.delete"),message:p.instant("namespace.warning.delete.selected"),warning:!0}).result.then((function(){e.loader=!0;const a=[];angular.forEach(e.displayedNamespaces,(function(e){e.selected&&a.push(e)})),g(a.shift(),a),e.selectedAll=!1}),(function(){e.getNamespaces(),e.selectedAll=!1,e.searchNamespaces=""})))}))};const g=(a,s)=>{let r;r="object"==typeof a?a.prefix:a,o.deleteNamespacePrefix(t.getActiveRepository(),r).success((function(){s&&s.length>0?(a=s.shift(),g(a,s)):(e.selectedAll=!1,e.namespace={},e.getNamespaces(),e.searchNamespaces="",e.haveSelected=!1,e.loader=!1,e.displayedNamespaces=[],void 0===s?n.success(p.instant("namespace.prefix.deleted.successfully",{prefix:r}),""):n.success(p.instant("namespace.selected.namespaces.deleted.successfully"),""))})).error((function(a){const t=getError(a);n.error(t,p.instant("common.error")),e.loader=!1}))};e.checkIfSelectedNamespace=function(){e.haveSelected=!1,angular.forEach(e.namespaces,(function(a){a.selected&&(e.haveSelected=!0)}))};const h=function(){angular.forEach(e.namespaces,(function(e){e.selected=!1}))},v=(e,a)=>function(e){return""===e||e.match(s)}(e)?!angular.isUndefined(a)&&""!==a||(n.error(p.instant("namespace.warning.provide.namespace"),p.instant("common.error")),!1):(n.error(p.instant("namespace.invalid.prefix",{prefix:e},p.instant("common.error"))),!1)}]),n.controller("StandartModalCtrl",["$scope","$uibModalInstance",function(e,a){e.ok=function(){a.close(!0)},e.cancel=function(){a.dismiss("cancel")}}])},300:function(e,a){angular.module("graphdb.framework.namespaces.directives",["ngRoute"]).directive("loaderPostRepeatDirective",["$timeout",function(e){return function(a){a.$last&&e((function(){a.$parent.loader=!1}),0)}}])},380:function(e,a,t){"use strict";t.r(a);t(9),t(40),t(41),t(299),t(300),t(118),t(652);angular.module("graphdb.framework.namespaces",["LocalStorageModule","xeditable","ngAnimate","ngRoute","toastr","graphdb.framework.namespaces.controllers","graphdb.framework.namespaces.directives","graphdb.framework.core.services.repositories","graphdb.framework.core.directives","graphdb.framework.core.directives.paginations"]).run(["editableOptions",function(e){e.theme="bs3"}])}}]);