{"version":3,"sources":["webpack:///./src/js/angular/stats/app.js"],"names":["angular","module","controller","$scope","$http","toastr","$timeout","$jwtAuth","$translate","get","success","data","info","error","msg","getError","instant","getReportStatus","statusElements","split","status","timestamp","errorMessage","getReport","url","isAuthenticated","encodeURIComponent","getAuthToken","window","open","makeReport","post"],"mappings":"4FAAA,YAEqBA,QAAQC,OAAO,0BAA2B,CAAC,WAEnDC,WAAW,gBAAiB,CAAC,SAAU,QAAS,SAAU,WAAY,WAAY,aAC3F,SAAUC,EAAQC,EAAOC,EAAQC,EAAUC,EAAUC,GAEjDJ,EAAMK,IAAI,kBACLC,SAAQ,SAAUC,GACfR,EAAOS,KAAOD,KAEjBE,OAAM,SAAUF,GACb,MAAMG,EAAMC,SAASJ,GACrBN,EAAOQ,MAAMC,EAAKN,EAAWQ,QAAQ,oBAK7Cb,EAAOc,gBAAkB,WACrBb,EAAMK,IAAI,sBACLC,SAAQ,SAAUC,GACf,MAAMO,EAAiBP,EAAKQ,MAAM,IAAK,GACvChB,EAAOiB,OAASF,EAAe,GAC/Bf,EAAOkB,UAAYH,EAAe,GAClCf,EAAOmB,aAAeJ,EAAe,GAEf,gBAAlBf,EAAOiB,QACPd,EAASH,EAAOc,gBAAiB,QAGxCJ,OAAM,SAAUF,GACb,MAAMG,EAAMC,SAASJ,GACrBN,EAAOQ,MAAMC,EAAKN,EAAWQ,QAAQ,qBAIjDb,EAAOc,kBAEPd,EAAOoB,UAAY,WACf,IAAIC,EAAM,cACNjB,EAASkB,oBACTD,EAAMA,EAAM,cAAgBE,mBAAmBnB,EAASoB,iBAG5DC,OAAOC,KAAKL,IAGhBrB,EAAO2B,WAAa,WAChB1B,EAAM2B,KAAK,eACNrB,SAAQ,WACLP,EAAOiB,OAAS,cAChBd,EAASH,EAAOc,gBAAiB,QAEpCJ,OAAM,SAAUF,GACb,MAAMG,EAAMC,SAASJ,GACrBN,EAAOQ,MAAMC,EAAKN,EAAWQ,QAAQ","file":"130.08f813a84955d0d95c4d.bundle.js","sourcesContent":["import 'angular/core/services';\n\nconst adminInfoApp = angular.module('graphdb.framework.stats', ['toastr']);\n\nadminInfoApp.controller('AdminInfoCtrl', ['$scope', '$http', 'toastr', '$timeout', '$jwtAuth', '$translate',\n    function ($scope, $http, toastr, $timeout, $jwtAuth, $translate) {\n\n        $http.get('rest/info/data')\n            .success(function (data) {\n                $scope.info = data;\n            })\n            .error(function (data) {\n                const msg = getError(data);\n                toastr.error(msg, $translate.instant('common.error'));\n            });\n\n\n        //NONE, IN_PROGRESS, READY\n        $scope.getReportStatus = function () {\n            $http.get('rest/report/status')\n                .success(function (data) {\n                    const statusElements = data.split('|', 3);\n                    $scope.status = statusElements[0];\n                    $scope.timestamp = statusElements[1];\n                    $scope.errorMessage = statusElements[2];\n\n                    if ($scope.status === 'IN_PROGRESS') {\n                        $timeout($scope.getReportStatus, 3000);\n                    }\n                })\n                .error(function (data) {\n                    const msg = getError(data);\n                    toastr.error(msg, $translate.instant('common.error'));\n                });\n        };\n\n        $scope.getReportStatus();\n\n        $scope.getReport = function () {\n            let url = 'rest/report';\n            if ($jwtAuth.isAuthenticated()) {\n                url = url + '?authToken=' + encodeURIComponent($jwtAuth.getAuthToken());\n            }\n\n            window.open(url);\n        };\n\n        $scope.makeReport = function () {\n            $http.post('rest/report')\n                .success(function () {\n                    $scope.status = 'IN_PROGRESS';\n                    $timeout($scope.getReportStatus, 2000);\n                })\n                .error(function (data) {\n                    const msg = getError(data);\n                    toastr.error(msg, $translate.instant('common.error'));\n                });\n        };\n    }]);\n"],"sourceRoot":""}