(window.webpackJsonp=window.webpackJsonp||[]).push([[36,65,78,101,236,257,258,260,261],{124:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilaritySearchType",(function(){return r}));const r={SEARCH_TERM:"searchTerm",SEARCH_ANALOGICAL:"searchAnalogical",SEARCH_ENTITY:"searchEntity",SEARCH_ENTITY_PREDICATE:"searchEntityPredicate",SEARCH_DOCUMENT:"searchDocumentID",isSearchTermType:e=>r.SEARCH_TERM===e,isSearchAnalogicalType:e=>r.SEARCH_ANALOGICAL===e,isSearchEntityType:e=>r.SEARCH_ENTITY===e,isSearchEntityPredicateType:e=>r.SEARCH_ENTITY_PREDICATE===e,isSearchDocumentType:e=>r.SEARCH_DOCUMENT===e}},191:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilarityResultType",(function(){return r}));const r={TERM_RESULT:"termResult",DOCUMENT_RESULT:"documentResult",ENTITY_RESULT:"entityResult",isResultDocumentType:e=>r.DOCUMENT_RESULT===e,isResultTermType:e=>r.TERM_RESULT===e}},192:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilaritySearch",(function(){return a}));var r=i(124);class a{constructor(){this.type=r.SimilaritySearchType.SEARCH_TERM,this.predicate="",this.termOrSubject=""}isSearchAnalogicalType(){return r.SimilaritySearchType.isSearchAnalogicalType(this.type)}isSearchTermType(){return r.SimilaritySearchType.isSearchTermType(this.type)}isSearchEntityType(){return r.SimilaritySearchType.isSearchEntityType(this.type)}isSearchEntityPredicateType(){return r.SimilaritySearchType.isSearchEntityPredicateType(this.type)}isSearchDocumentType(){return r.SimilaritySearchType.isSearchDocumentType(this.type)}}},310:function(e,t,i){"use strict";i.r(t);i(23),i(47);var r=i(0),a=i(124),s=i(191),n=i(93),c=i(91),l=i(98),o=i(192),y=i(89),p=i(8);function u(e,t,i,u,S,d,T,m,h,I,E,R,x,g,A,b){const v="http://www.ontotext.com/graphdb/similarity/",L="http://www.ontotext.com/graphdb/similarity/psi/",Q=L+"any";e.pluginName="similarity",e.pluginIsActive=!0,e.isLoading=!1,e.selectedSimilarityIndex=void 0,e.similarityIndexStatus=n.SimilarityIndexStatus,e.similarityIndexType=c.SimilarityIndexType,e.similaritySearchType=a.SimilaritySearchType,e.searchType=a.SimilaritySearchType.SEARCH_TERM,e.similarityResultType=s.SimilarityResultType,e.resultType=s.SimilarityResultType.TERM_RESULT,e.info=E,e.isGraphDBRepository=void 0,e.canEditRepo=e.canWriteActiveRepo(),e.loadSimilarityIndexesTimer=void 0,e.loadSimilarityIndexes=()=>{e.isGraphDBRepository&&e.pluginIsActive&&h.getIndexes().success(t=>e.similarityIndexes=Object(l.mapIndexesResponseToSimilarityIndex)(t)).error(e=>i.error(getError(e),x.instant("similarity.could.not.get.indexes.error")))},e.reloadSimilarityIndexes=()=>{e.loadSimilarityIndexes(),e.loadSimilarityIndexesTimer||(e.loadSimilarityIndexesTimer=t((function(){e.$broadcast("checkIsActive"),"false"!==$("#indexes-table").attr("aria-expanded")&&e.loadSimilarityIndexes()}),5e3))},e.goToSimilarityIndex=t=>{(t.isBuiltStatus()||t.isOutdatedStatus()||t.isRebuildingStatus())&&(e.empty=!0,e.selectedSimilarityIndex!==t&&(e.lastSearch=void 0,e.selectedSimilarityIndex=t),t.isTextType()?e.searchType=a.SimilaritySearchType.SEARCH_TERM:t.isPredicationType()&&(e.searchType=a.SimilaritySearchType.SEARCH_ENTITY),(t.isTextType()||t.isPredicationType())&&$("#indexes-table").collapse("hide"))},e.performSearch=(t,r,a,s,n)=>{e.isLoading=!0,M(a,r);const c=B(t,r,a,s,n);g.getQueryResult(u.getActiveRepository(),c,"application/x-sparqlstar-results+json, application/sparql-results+json;q=0.9, */*;q=0.8").then(e=>q(e)).catch(e=>i.error(getError(e.data),x.instant("similarity.get.resource.error"))).finally(()=>e.isLoading=!1)},e.viewSearchQuery=()=>{let t;t=e.lastSearch.isSearchAnalogicalType()?e.selectedSimilarityIndex.analogicalQuery?e.selectedSimilarityIndex.analogicalQuery:e.searchQueries.analogical:e.selectedSimilarityIndex.searchQuery?e.selectedSimilarityIndex.searchQuery:e.searchQueries[e.selectedSimilarityIndex.type];let i=[],r="";i=t.match(/[a-zA-Z0-9-]+:<http:\/\/www.ontotext.com\/graphdb\/similarity\/instance\/>/),r=null==i?"similarity-index":i[0].substring(0,i[0].indexOf(":"));const s=t.replace("?index",r+":"+e.selectedSimilarityIndex.name).replace("?query",e.lastSearch.termOrSubject).replace("?searchType",(e.selectedSimilarityIndex.isTextType()?":":"psi:")+(e.lastSearch.isSearchEntityPredicateType()?a.SimilaritySearchType.SEARCH_ENTITY:e.lastSearch.type)).replace("?resultType",e.selectedSimilarityIndex.isTextType()?":"+e.resultType:"psi:entityResult").replace("?parameters",O(e.searchParameters?e.searchParameters:"")).replace("?psiPredicate",e.lastSearch.predicate?D(e.lastSearch.predicate):D(Q)).replace("?givenSubject",D(e.analogicalSubject)).replace("?givenObject",D(e.analogicalObject)).replace("?searchSubject",D(e.searchSubject));m.open({templateUrl:"pages/viewQuery.html",controller:"ViewQueryCtrl",resolve:{query:()=>s}})},e.deleteSimilarityIndex=t=>{T.openSimpleModal({title:x.instant("common.confirm"),message:x.instant("similarity.delete.index.warning",{name:t.name}),warning:!0}).result.then((function(){h.deleteIndex(t).then(()=>e.loadSimilarityIndexes()).catch(e=>i.error(getError(e)))}))},e.viewCreateQuery=e=>{h.getQuery({indexName:e.name,indexOptions:e.options,query:e.selectQuery,indexStopList:e.stopList,queryInference:e.infer,querySameAs:e.sameAs,viewType:e.type,indexAnalyzer:e.analyzer}).success(e=>{m.open({templateUrl:"pages/viewQuery.html",controller:"ViewQueryCtrl",resolve:{query:()=>e}})})},e.rebuildIndex=t=>{t.searchQuery||(t.searchQuery=t.type?e.searchQueries[t.type]:e.searchQueries.text),T.openSimpleModal({title:x.instant("common.confirm"),message:Object(r.decodeHTML)(x.instant("similarity.rebuild.index.warning",{name:t.name})),warning:!0}).result.then(()=>{t.status=n.SimilarityIndexStatus.REBUILDING,h.rebuildIndex(t).catch(e=>i.error(getError(e)))})},e.setPluginIsActive=t=>{e.pluginIsActive=t},e.encodeURIComponent=e=>encodeURIComponent(e),e.copyToClipboardResult=e=>{T.openCopyToClipboardModal(e)},e.trimIRI=e=>_.trim(e,"<>"),e.updateSearchType=t=>{e.searchType=t},e.updateResultType=t=>{e.resultType=t},e.editSimilarityIndex=e=>{w(e)},e.cloneSimilataryIndex=e=>{w(e,!0)},e.setPsiSubject=t=>{e.psiSubject=t},e.setAnalogicalSubject=t=>{e.analogicalSubject=t},e.setAnalogicalObject=t=>{e.analogicalObject=t};const w=(e,t=!1)=>{const i={selectQuery:e.selectQuery,options:e.options,name:e.name,editSearchQuery:!t,infer:e.infer,sameAs:e.sameAs,stopList:e.stopList,type:e.type,analyzer:e.analyzer,searchQuery:e.searchQuery?e.searchQuery:"",analogicalQuery:e.analogicalQuery?e.analogicalQuery:""};d.path("similarity/index/create").search(i)},C=()=>{const t=e.getActiveRepository();t&&e.activeRepository!==t&&(e.canEditRepo=e.canWriteActiveRepo(),e.activeRepository=t,e.isGraphDBRepository=N(),e.isGraphDBRepository&&(S.isLicenseValid()&&e.reloadSimilarityIndexes(),f()))},f=()=>{h.getSearchQueries().success(t=>e.searchQueries=t).error(e=>i.error(getError(e),x.instant("similarity.could.not.get.search.queries.error")))},O=e=>'"'+e+'"',D=e=>void 0===e||e.startsWith("<<")&&e.endsWith(">>")?e:"<"+e+">",N=()=>e.getActiveRepository()&&!e.isActiveRepoOntopType()&&!e.isActiveRepoFedXType(),U=[];U.push(e.$on("repositoryIsSet",C));e.$on("$destroy",()=>{j(),e.loadSimilarityIndexesTimer&&t.cancel(e.loadSimilarityIndexesTimer)});const j=()=>{U.forEach(e=>e())};U.push(A.onAutocompleteEnabledUpdated(t=>{e.isAutocompleteEnabled=t})),U.push(A.onSelectedRepositoryIdUpdated(t=>{t?b.getNamespaces(t).then(t=>{e.repositoryNamespaces=t}).catch(e=>{const t=getError(e);i.error(t,x.instant("error.getting.namespaces.for.repo"))}):e.repositoryNamespaces=new p.NamespacesListModel}));U.push(e.$watch("searchType",()=>{e.empty=!0}));const P=e.$watch(e.getActiveRepositoryObject,e=>{e&&(C(),P())}),B=(t,i,r,n,c)=>{const l={query:G(e.lastSearch.type),$index:D("http://www.ontotext.com/graphdb/similarity/instance/"+t.name),$query:e.lastSearch.termOrSubject,$searchType:D((e.selectedSimilarityIndex.isTextType()?v:L)+(a.SimilaritySearchType.isSearchEntityPredicateType(r)?a.SimilaritySearchType.SEARCH_ENTITY:r)),$resultType:D(e.selectedSimilarityIndex.isTextType()?v+n:L+s.SimilarityResultType.ENTITY_RESULT),$parameters:O(c)};return a.SimilaritySearchType.isSearchEntityPredicateType(r)&&(l.$psiPredicate=e.lastSearch.predicate?D(e.lastSearch.predicate):D(Q)),a.SimilaritySearchType.isSearchAnalogicalType(r)&&(e.searchSubject=i,l.$givenSubject=D(e.analogicalSubject),l.$givenObject=D(e.analogicalObject),l.$searchSubject=D(i)),l},M=(t,i)=>{e.lastSearch=new o.SimilaritySearch,e.lastSearch.type=t,a.SimilaritySearchType.isSearchEntityPredicateType(t)&&(e.lastSearch.predicate=i),e.lastSearch.termOrSubject=H(e.lastSearch.type,i,e.psiSubject)},G=t=>{let i;return i=a.SimilaritySearchType.isSearchAnalogicalType(t)?e.selectedSimilarityIndex.analogicalQuery?e.selectedSimilarityIndex.analogicalQuery:e.searchQueries.analogical:e.selectedSimilarityIndex.searchQuery?e.selectedSimilarityIndex.searchQuery:e.searchQueries[e.selectedSimilarityIndex.type],i},H=(e,t,i)=>{let r=t;return r=a.SimilaritySearchType.isSearchEntityPredicateType(e)?i:a.SimilaritySearchType.isSearchTermType(e)?O(r):D(r),r},q=t=>{e.yasguiConfig={showEditorTabs:!1,showToolbar:!1,showResultTabs:!1,showQueryButton:!1,downloadAsOn:!1,showResultInfo:!1,componentId:"similarity-list-component",maxPersistentResponseSize:0,render:y.RenderingMode.YASR,sparqlResponse:t.data}}}angular.module("graphdb.framework.similarity.controllers.list",["graphdb.core.services.workbench-context","graphdb.framework.core.services.rdf4j.repositories"]).controller("SimilarityCtrl",u),u.$inject=["$scope","$interval","toastr","$repositories","$licenseService","$location","ModalService","$uibModal","SimilarityRestService","AutocompleteRestService","productInfo","RDF4JRepositoriesRestService","$translate","SparqlRestService","WorkbenchContextService","RDF4JRepositoriesService"]},89:function(e,t,i){"use strict";i.r(t),i.d(t,"RenderingMode",(function(){return r}));const r={YASGUI:"mode-yasgui",YASQE:"mode-yasqe",YASR:"mode-yasr"}},91:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilarityIndexType",(function(){return r}));const r={TEXT:"text",TEXT_LITERAL:"textLiteral",PREDICATION:"predication",isTextType:e=>r.TEXT===e,isTextLiteralType:e=>r.TEXT_LITERAL===e,isPredicationType:e=>r.PREDICATION===e}},93:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilarityIndexStatus",(function(){return r}));const r={CREATING:"CREATING",BUILDING:"BUILDING",BUILT:"BUILT",REBUILDING:"REBUILDING",OUTDATED:"OUTDATED",INTERRUPTED:"INTERRUPTED",OBSOLETE:"OBSOLETE",FAILED:"FAILED",isCreatingStatus:e=>r.CREATING===e,isBuildingStatus:e=>r.BUILDING===e,isBuiltStatus:e=>r.BUILT===e,isRebuildingStatus:e=>r.REBUILDING===e,isOutdatedStatus:e=>r.OUTDATED===e,isInterruptedStatus:e=>r.INTERRUPTED===e,isObsoleteStatus:e=>r.OBSOLETE===e,isFailedStatus:e=>r.FAILED===e}},94:function(e,t,i){"use strict";i.r(t),i.d(t,"SimilarityIndex",(function(){return s}));var r=i(91),a=i(93);class s{constructor(){this.analyzer="",this.infer=!0,this.options="",this.sameAs=!0,this.searchQuery="",this.selectQuery="",this.stopList=void 0,this.name="",this.type=r.SimilarityIndexType.TEXT,this.status=void 0,this.analogicalQuery=void 0,this.inputIndex=void 0,this.isLiteralIndex=""}isTextType(){return r.SimilarityIndexType.isTextType(this.type)}isTextLiteralType(){return r.SimilarityIndexType.isTextLiteralType(this.type)}isPredicationType(){return r.SimilarityIndexType.isPredicationType(this.type)}isCreatingStatus(){return a.SimilarityIndexStatus.isCreatingStatus(this.status)}isBuildingStatus(){return a.SimilarityIndexStatus.isBuildingStatus(this.status)}isBuiltStatus(){return a.SimilarityIndexStatus.isBuiltStatus(this.status)}isRebuildingStatus(){return a.SimilarityIndexStatus.isRebuildingStatus(this.status)}isOutdatedStatus(){return a.SimilarityIndexStatus.isOutdatedStatus(this.status)}isInterruptedStatus(){return a.SimilarityIndexStatus.isInterruptedStatus(this.status)}isObsoleteStatus(){return a.SimilarityIndexStatus.isObsoleteStatus(this.status)}isFailedStatus(){return a.SimilarityIndexStatus.isFailedStatus(this.status)}}},98:function(e,t,i){"use strict";i.r(t),i.d(t,"mapIndexesResponseToSimilarityIndex",(function(){return a}));var r=i(94);const a=e=>e.map(e=>{const t=new r.SimilarityIndex;return t.type=e.type,t.stopList=e.stopList,t.status=e.status,t.selectQuery=e.selectQuery,t.searchQuery=e.searchQuery,t.sameAs=e.sameAs,t.options=e.options,t.name=e.name,t.infer=e.infer,t.analyzer=e.analyzer,t.analogicalQuery=e.analogicalQuery,t})}}]);